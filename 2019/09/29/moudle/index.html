<!DOCTYPE html>
<html lang="zh-CN">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <meta name="renderer" content="webkit">

  
  <title>WEB 前端模块化都有什么？ | 哆龙的博客</title>

  <link rel="shortcut icon" href="/images/favicon.png">
  
  <meta name="description" content="前言说到前端模块化，你第一时间能想到的是什么？Webpack？ES6 Module？还有吗？我们一起来看一下下图。    相信大伙儿对上图的单词都不陌生，可能用过、看过或者是只是听过。那你能不能用一张图梳理清楚上述所有词汇之间的关系呢？我们日常编写代码的时候，又和他们之间的谁谁谁有关系呢？ 一、千丝万缕为了更贴合我们的日常开发场景（前后端分离），我们尝试先从不同平台的维度区分，作为本文的切入点">
<meta name="keywords" content="js,es6">
<meta property="og:type" content="article">
<meta property="og:title" content="WEB 前端模块化都有什么？">
<meta property="og:url" content="https://longhonour.github.io/2019/09/29/moudle/index.html">
<meta property="og:site_name" content="哆龙的博客">
<meta property="og:description" content="前言说到前端模块化，你第一时间能想到的是什么？Webpack？ES6 Module？还有吗？我们一起来看一下下图。    相信大伙儿对上图的单词都不陌生，可能用过、看过或者是只是听过。那你能不能用一张图梳理清楚上述所有词汇之间的关系呢？我们日常编写代码的时候，又和他们之间的谁谁谁有关系呢？ 一、千丝万缕为了更贴合我们的日常开发场景（前后端分离），我们尝试先从不同平台的维度区分，作为本文的切入点">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/11/21/16734e3a0fa304fc?imageView2/0/w/1280/h/960/format/webp/ignore-error/1">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2018/11/21/16734e324a8c8d28?imageView2/0/w/1280/h/960/format/webp/ignore-error/1">
<meta property="og:updated_time" content="2019-09-29T06:56:30.767Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="WEB 前端模块化都有什么？">
<meta name="twitter:description" content="前言说到前端模块化，你第一时间能想到的是什么？Webpack？ES6 Module？还有吗？我们一起来看一下下图。    相信大伙儿对上图的单词都不陌生，可能用过、看过或者是只是听过。那你能不能用一张图梳理清楚上述所有词汇之间的关系呢？我们日常编写代码的时候，又和他们之间的谁谁谁有关系呢？ 一、千丝万缕为了更贴合我们的日常开发场景（前后端分离），我们尝试先从不同平台的维度区分，作为本文的切入点">
<meta name="twitter:image" content="https://user-gold-cdn.xitu.io/2018/11/21/16734e3a0fa304fc?imageView2/0/w/1280/h/960/format/webp/ignore-error/1">

  <meta name="format-detection" content="telephone=no,email=no">
  <meta name="theme-color" content="#9C27B0">
  <meta name="description" content>
  <meta name="keywords" content=",js,es6">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="哆龙的博客">
  <meta name="msapplication-starturl" content="https://longhonour.github.io/2019/09/29/moudle/">
  <meta name="msapplication-navbutton-color" content="#9C27B0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="哆龙的博客">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/images/favicon.png">

  
    <meta property="article:published_time" content="Sun Sep 29 2019 14:28:26 GMT+0800">
    <meta property="article:modified_time" content="Sun Sep 29 2019 14:56:30 GMT+0800">
  

  
    <link rel="canonical" href="https://longhonour.github.io/2019/09/29/moudle/">
  

  
  

  
  
  

  <link rel="stylesheet" href="/css/mdui.css">
<link rel="stylesheet" href="/css/style.css">
</head>
<body class="mdui-appbar-with-toolbar mdui-drawer-body-left mdui-theme-primary-deep-purple mdui-theme-accent-blue">
  <script>var a=localStorage.getItem("mdui-theme-layout-dark");if(a){document.getElementsByTagName("body")[0].className+=" mdui-theme-layout-dark"};</script>
  <header id="header" class="mdui-appbar mdui-appbar-fixed mdui-appbar-scroll-hide mdui-appbar-inset">
  <div class="mdui-toolbar mdui-color-theme">
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="mdui-icon material-icons">menu</i></a>
    <a href="/" class="mdui-typo-headline">哆龙的博客</a>
    <div class="mdui-toolbar-spacer"></div>
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: '搜索'}"><i class="mdui-icon material-icons">search</i></a>
    
  </div>
</header>
<div class="mdui-dialog" id="search">
  
    <div class="search-form">
      <input type="search" class="search-form-input" placeholder="请输入关键字搜索">
    </div>
    <div class="search-result" data-resource="/search.xml"></div>
  
</div>
  <aside id="sidebar" class="mdui-drawer mdui-drawer-full-height">
  <div class="mdui-grid-tile">
    <img src="/images/banner.png" style="height: 160px;">
    <img src="/images/avatar.png" class="avatar-animation" style="position: absolute; top: 10%; left: 50%; margin-left: -32px; width: 64px; height: 64px; border: 2px solid #fff; border-radius: 50%;">
    <div class="mdui-grid-tile-actions">
      <div class="mdui-grid-tile-text">
        <div class="mdui-grid-tile-title">Cao Long</div>
        <div class="mdui-grid-tile-subtitle"><i class="mdui-icon material-icons">art_track</i>竹杖芒鞋轻胜马，谁怕？</div>
      </div>
      
        <div class="mdui-grid-tile-buttons">
          <a href="mailto:2286410840cl@gmail.com" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: '2286410840cl@gmail.com'}"><i class="mdui-icon material-icons">email</i></a>
        </div>
      
    </div>
  </div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    <a href="/" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">home</i>
      <div class="mdui-list-item-content">主页</div>
    </a>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-deep-orange">inbox</i>
        <div class="mdui-list-item-content">归档</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/archives/2019/09/">九月 2019<span class="mdui-ripple sidebar_archives-count">4</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-green">chrome_reader_mode</i>
        <div class="mdui-list-item-content">分类</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/categories/web前端/">web前端<span class="mdui-ripple sidebar_archives-count">4</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-brown">bookmark</i>
        <div class="mdui-list-item-content">标签</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/tags/css/">css<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/es6/">es6<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/js/">js<span class="mdui-ripple sidebar_archives-count">3</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/webpack/">webpack<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/浏览器原理/">浏览器原理<span class="mdui-ripple sidebar_archives-count">1</span></a>
        
      </div>
    </div>
    <a href="/about" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-purple">person</i>
      <div class="mdui-list-item-content">关于</div>
    </a>
  </div>

  <div class="mdui-divider"></div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <div class="mdui-list-item-content">友情链接</div>
        <i class="mdui-list-item-icon mdui-icon material-icons">link</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
          <a href="https://github.com/longhonour" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">Github</a>
        
        
      </div>
    </div>
  </div>
</aside>
  <main id="main" class="mdui-m-t-5 fadeIn animated">
  <link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css">
  <style>#main article .mdui-card-content .center-block{display:block!important;margin-right:auto!important;margin-left:auto!important}</style>
  <article class="mdui-card mdui-m-b-5">
    <header class="mdui-card-media">
      <img src="/images/random/material-13.png" style="max-height: 240px;">
      <div class="mdui-card-media-covered">
        <div class="mdui-card-primary">
          <div class="mdui-card-primary-title">WEB 前端模块化都有什么？</div>
          <div class="mdui-card-primary-subtitle"><i class="iconfont">&#xe697;</i> 2019-09-29 / <i class="iconfont">&#xe601;</i> Cao Long</div>
        </div>
      </div>
      <div class="mdui-card-menu">
        
          <button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#qrcode', align: 'right'}"><i class="mdui-icon material-icons">devices</i></button>
          <ul class="mdui-menu" id="qrcode">
            
              <li class="mdui-menu-item"><a class="mdui-text-center mdui-ripple">移动端查看</a></li>
            
            <li class="mdui-menu-item" disabled>
              
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACZ0lEQVR42u3aUU7DMBAE0N7/0nCAKnTGG5uoevmqSsB5RopXs/v6+errhYeHh4eHh4eH9zDeK77ef+tygeCnyd9cfDY8PDy8I7wPr9rgnoTx/jm5p302PDw8vJO8tSX//qY9QibbgYeHh/dkXlLatsX0/CDBw8PDez4vYVzduXbA4OHh4T2NlxS+kwJ6rYw+mrXg4eHhxby8yXT+89H+Hh4eHl7AW2trrd0/CTKKFfHw8PA289aWb4ex1oryte3Aw8PD283LHyuJU/MWVxTI/rlKFEbg4eHhbeAlsemOV3nbJCsGufDw8PA289qIoR0peJVXfiBdbgoeHh7eEd5aIds2tNaK+Db+wMPDw3sCLy+vk4A4b62tDc7i4eHhneclJewkhM1bYm3ZjYeHh3eGt6P9P/kmb6fVKTUeHh7eTbzJwZAME0QPFAcfN4QReHh4eGNeXjTnkW4bMbRF+QcwHh4e3mZe3gDLg4M8sEiOmfzv4OHh4Z3h5YNQd7W7ckD7bHh4eHhneGtN+nbJe1tiHw42PDw8vM28NmxNFpiEFG1sEWUteHh4eJt5bXOr3YJJgBttHB4eHt5B3mSYoHhxD8rxaJgADw8P759486Gru8D1cAMeHh7eZl57JcNY9ZjUeLwADw8P7yRv0qRvHygv1tv2GB4eHt55XnIY5AXxJMLIS3w8PDy8J/DmL+h2vHVtUPXDPwMPDw/vkbz2OEm+aTfu8k48PDy8R/KuqHmAm8e77ebi4eHhneS1r/hJoytvpx2NcfHw8PA2NMDWXt/zI6RovOHh4eFt5n3fhYeHh4eHh4eH94DrF1YvupbuRzpqAAAAAElFTkSuQmCC">
              
            </li>
          </ul>
        
        
          <button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#share_menu', align: 'right'}"><i class="mdui-icon material-icons">share</i></button>
          <ul class="mdui-menu" id="share_menu">
            <li class="mdui-menu-item">
              <a href="http://service.weibo.com/share/share.php?appkey=&title=WEB 前端模块化都有什么？&url=https://longhonour.github.io/2019/09/29/moudle/&pic=https://longhonour.github.io/images/favicon.png&searchPic=false&style=simple" target="_blank" class="mdui-ripple">分享到微博</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://twitter.com/intent/tweet?text=WEB 前端模块化都有什么？&url=https://longhonour.github.io/2019/09/29/moudle/&via=Cao Long" target="_blank" class="mdui-ripple">分享到Twitter</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://www.facebook.com/sharer/sharer.php?u=https://longhonour.github.io/2019/09/29/moudle/" target="_blank" class="mdui-ripple">分享到Facebook</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://longhonour.github.io/2019/09/29/moudle/&title=WEB 前端模块化都有什么？" target="_blank" class="mdui-ripple">分享到LinkedIn</a>
            </li>
            <li class="mdui-menu-item">
              <a href="http://connect.qq.com/widget/shareqq/index.html?site=哆龙的博客&title=WEB 前端模块化都有什么？&summary=&pics=https://longhonour.github.io/images/favicon.png&url=https://longhonour.github.io/2019/09/29/moudle/" target="_blank" class="mdui-ripple">分享到QQ</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://telegram.me/share/url?url=https://longhonour.github.io/2019/09/29/moudle/&text=WEB 前端模块化都有什么？" target="_blank" class="mdui-ripple">分享到Telegram</a>
            </li>
          </ul>
        
      </div>
    </header>
    <div class="mdui-card-content mdui-typo">
      <p><img src="https://user-gold-cdn.xitu.io/2018/11/21/16734e3a0fa304fc?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="总结"></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>说到前端模块化，你第一时间能想到的是什么？Webpack？ES6 Module？还有吗？我们一起来看一下下图。 </p>
<p><img src="https://user-gold-cdn.xitu.io/2018/11/21/16734e324a8c8d28?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="模块化关键词"></p>
<p> 相信大伙儿对上图的单词都不陌生，可能用过、看过或者是只是听过。那你能不能用一张图梳理清楚上述所有词汇之间的关系呢？我们日常编写代码的时候，又和他们之间的谁谁谁有关系呢？</p>
<h2 id="一、千丝万缕"><a href="#一、千丝万缕" class="headerlink" title="一、千丝万缕"></a>一、千丝万缕</h2><p>为了更贴合我们的日常开发场景（前后端分离），我们尝试先从不同平台的维度区分，作为本文的切入点。</p>
<h3 id="1-根据平台划分"><a href="#1-根据平台划分" class="headerlink" title="1. 根据平台划分"></a>1. 根据平台划分</h3><table>
<thead>
<tr>
<th align="left">平台</th>
<th align="left">规范</th>
<th align="left">特性</th>
</tr>
</thead>
<tbody><tr>
<td align="left">浏览器</td>
<td align="left">AMD、CMD</td>
<td align="left">存在网络瓶颈，使用异步加载</td>
</tr>
<tr>
<td align="left">非浏览器</td>
<td align="left">CommonJS</td>
<td align="left">直接操作 IO，同步加载</td>
</tr>
</tbody></table>
<p>可以看到我们非常暴力的以是不是浏览器作为划分标准。仔细分析一下，他们之间最大的差异在于其特性上，是否存在瓶颈。 例如说网络性能瓶颈，每个模块的请求都需要发起一次网络请求，并等待资源下载完成后再进行下一步操作，那整个用户体验是非常糟糕的。 根据该场景，我们简化一下，以同步加载和异步加载两个维度进行区分。</p>
<table>
<thead>
<tr>
<th align="left">特性</th>
<th align="left">规范</th>
</tr>
</thead>
<tbody><tr>
<td align="left">同步加载</td>
<td align="left">CommonJS</td>
</tr>
<tr>
<td align="left">异步加载</td>
<td align="left">AMD、CMD</td>
</tr>
</tbody></table>
<h3 id="2-AMD、CMD-两大规范"><a href="#2-AMD、CMD-两大规范" class="headerlink" title="2. AMD、CMD 两大规范"></a>2. AMD、CMD 两大规范</h3><p>先忽略 CommonJS，我们先介绍下，曾经一度盛行的 AMD、CMD 两大规范。</p>
<table>
<thead>
<tr>
<th align="left">规范</th>
<th align="left">约束条件</th>
<th align="left">代表作</th>
</tr>
</thead>
<tbody><tr>
<td align="left">AMD</td>
<td align="left">依赖前置</td>
<td align="left">requirejs</td>
</tr>
<tr>
<td align="left">CMD</td>
<td align="left">就近依赖</td>
<td align="left">seajs</td>
</tr>
</tbody></table>
<p>AMD、CMD 提供了封装模块的方法，实现语法上相近，甚至于 requirejs 在后期也默默支持了 CMD 的写法。我们用一个例子，来讲清楚这两个规范之间最大的差异：依赖前置和就近依赖。</p>
<p><em>AMD:</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// hello.js</span><br><span class="line">define(function() &#123;</span><br><span class="line">    console.log(&apos;hello init&apos;);</span><br><span class="line">    return &#123;</span><br><span class="line">        getMessage: function() &#123;</span><br><span class="line">            return &apos;hello&apos;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line">// world.js</span><br><span class="line">define(function() &#123;</span><br><span class="line">    console.log(&apos;world init&apos;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// main</span><br><span class="line">define([&apos;./hello.js&apos;, &apos;./world.js&apos;], function(hello) &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">        sayHello: function() &#123;</span><br><span class="line">            console.log(hello.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 输出</span><br><span class="line">// hello init</span><br><span class="line">// world init</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><em>CMD:</em></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">// hello.js</span><br><span class="line">define(function(require, exports) &#123;</span><br><span class="line">    console.log(&apos;hello init&apos;);</span><br><span class="line">    exports.getMessage = function() &#123;</span><br><span class="line">        return &apos;hello&apos;;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// world.js</span><br><span class="line">define(function(require, exports) &#123;</span><br><span class="line">    console.log(&apos;world init&apos;);</span><br><span class="line">    exports.getMessage = function() &#123;</span><br><span class="line">        return &apos;world&apos;;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// main</span><br><span class="line">define(function(require) &#123;</span><br><span class="line">    var message;</span><br><span class="line">    if (true) &#123;</span><br><span class="line">        message = require(&apos;./hello&apos;).getMessage();</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        message = require(&apos;./world&apos;).getMessage();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// 输出</span><br><span class="line">// hello init</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><em>结论：</em> CMD 的输出结果中，没有打印”world init”。但是，<strong>需要注意的是，CMD 没有打印”world init”并是不 world.js 文件没有加载。AMD 与 CMD 都是在页面初始化时加载完成所有模块，唯一的区别就是就近依赖是当模块被 require 时才会触发执行。</strong></p>
<p>requirejs 和 seajs 的具体实现在这里就不展开阐述了，有兴趣的同学可以到官网了解一波，毕竟现在使用 requirejs 和 seajs 的应该很少了吧。</p>
<h3 id="3-CommonJS"><a href="#3-CommonJS" class="headerlink" title="3. CommonJS"></a>3. CommonJS</h3><p> 回到 CommonJS，写过 NodeJS 的同学对它肯定不会陌生。CommonJS 定义了，一个文件就是一个模块。在 node.js 的实现中，也给每个文件赋予了一个 module 对象，这个对象包括了描述当前模块的所有信息，我们尝试打印 module 对象。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">// index.js</span><br><span class="line">console.log(module);</span><br><span class="line"></span><br><span class="line">// 输出</span><br><span class="line">&#123;</span><br><span class="line">    id: &apos;/Users/x/Documents/code/demo/index.js&apos;,</span><br><span class="line">    exports: &#123;&#125;,</span><br><span class="line">    parent: &#123; module &#125;, // 调用该模块的模块，可以根据该属性查找调用链</span><br><span class="line">    filename: &apos;/Users/x/Documents/code/demo/index.js&apos;,</span><br><span class="line">    loaded: false,</span><br><span class="line">    children: [...],</span><br><span class="line">    paths: [...]</span><br><span class="line">&#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>也就是说，在 CommonJS 里面，模块是用对象来表示。我们通过“循环加载”的例子进行来加深了解。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// a.js</span><br><span class="line">exports.x = &apos;a1&apos;;</span><br><span class="line">console.log(&apos;a.js &apos;, require(&apos;./b.js&apos;).x);</span><br><span class="line">exports.x = &apos;a2&apos;;</span><br><span class="line"></span><br><span class="line">//b.js</span><br><span class="line">exports.x = &apos;b1&apos;;</span><br><span class="line">console.log(&apos;b.js &apos;, require(&apos;./a.js&apos;).x);</span><br><span class="line">exports.x = &apos;b2&apos;;</span><br><span class="line"></span><br><span class="line">//main</span><br><span class="line">console.log(&apos;index.js&apos;, require(&apos;./a.js&apos;).x);</span><br><span class="line"></span><br><span class="line">// 输出</span><br><span class="line">b.js  a1</span><br><span class="line">a.js  b2</span><br><span class="line">index.js  a2</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>我们的理论依据是模块对象，根据该依据我们进行如下分析。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1、 a.js准备加载，在内存中生成module对象moduleA</span><br><span class="line">2、 a.js执行exports.x = &apos;a1&apos;; 在moduleA的exports属性中添加x</span><br><span class="line">3、 a.js执行console.log(&apos;a.js&apos;, require(&apos;./b.js&apos;).x); 检测到require关键字，开始加载b.js，a.js执行暂停</span><br><span class="line">4、 b.js准备加载，在内存中生成module对象moduleB</span><br><span class="line">5、 b.js执行exports.x = &apos;b1&apos;; 在moduleB的exports属性中添加x</span><br><span class="line">6、 b.js执行console.log(&apos;b.js&apos;, require(&apos;./a.js&apos;).x); 检测到require关键字，开始加载a.js，b.js执行暂停</span><br><span class="line">7、 检测到内存中存在a.js的module对象moduleA，于是可以将第6步看成console.log(&apos;b.js&apos;, moduleA.x); 在第二步中moduleA.x赋值为a1，于是输出b.js, a1</span><br><span class="line">8、 b.js继续执行，exports.x = &apos;b2&apos;，改写moduleBexports的x属性</span><br><span class="line">9、 b.js执行完成，回到a.js，此时同理可以将第3步看成console.log(&apos;a.js&apos;, modulerB.x); 输出了a.js, b2</span><br><span class="line">10、 a.js继续执行，改写exports.x = &apos;a2&apos;</span><br><span class="line">11、 输出index.js a2</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>至此，“CommonJS 的模块，是一个对象。”这个概念大伙儿应该能理解吧？</p>
<p>回到这个例子，例子里面还出现了一个保留字 exports。其实 exports 是指向 module.exports 的一个引用。举个例子可以说明他们两个之间的关系。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">const myFuns = &#123; a: 1 &#125;;</span><br><span class="line">let moduleExports = myFuns;</span><br><span class="line">let myExports = moduleExports;</span><br><span class="line"></span><br><span class="line">// moduleExports 重新指向</span><br><span class="line">moduleExports = &#123; b: 2 &#125;;</span><br><span class="line">console.log(myExports);</span><br><span class="line">// 输出 &#123;a : 1&#125;</span><br><span class="line"></span><br><span class="line">// 也就是说在module.exports被重新复制时，exports与它的关系就gg了。解决方法就是重新指向</span><br><span class="line">myExports = modulerExports;</span><br><span class="line">console.log(myExports);</span><br><span class="line">// 输出 &#123; b: 2 &#125;</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<h3 id="4-ES6-module"><a href="#4-ES6-module" class="headerlink" title="4. ES6 module"></a>4. ES6 module</h3><p>对 ES6 有所了解的同志们应该都清楚，web 前端模块化在 ES6 之前，并不是语言规范，不像是其他语言 java、php 等存在命名空间或者包的概念。上文提及的 AMD、CMD、CommonJS 规范，都是为了基于规范实现的模块化，并非 JavaScript 语法上的支持。 我们先简单的看一个 ES6 模块化写法的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// a.js</span><br><span class="line">export const a = 1;</span><br><span class="line"></span><br><span class="line">// b.js</span><br><span class="line">export const b = 2;</span><br><span class="line"></span><br><span class="line">// main</span><br><span class="line">import &#123; a &#125; from &apos;./a.js&apos;;</span><br><span class="line">import &#123; b &#125; from &apos;./b.js&apos;;</span><br><span class="line">console.log(a, b);</span><br><span class="line">//输出 1 2</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>emmmm，没错，export 保留字看起来是不是和 CommonJS 的 exports 有点像？我们尝试  下从保留字对比 ES6 和 CommonJS。</p>
<table>
<thead>
<tr>
<th align="left">保留字</th>
<th align="left">CommonJS</th>
<th align="left">ES6</th>
</tr>
</thead>
<tbody><tr>
<td align="left">require</td>
<td align="left">支持</td>
<td align="left">支持</td>
</tr>
<tr>
<td align="left">export / import</td>
<td align="left">不支持</td>
<td align="left">支持</td>
</tr>
<tr>
<td align="left">exports / module.exports</td>
<td align="left">支持</td>
<td align="left">不支持</td>
</tr>
</tbody></table>
<p>好吧，除了 require 两个都可以用之外，其他实际上还是有明显差别的。那么问题来了，既然 require 两个都可以用，那这两个在 require 使用上，有差异吗？</p>
<p>我们先对比下 ES6 module 和 CommonJS 之间的差异。</p>
<table>
<thead>
<tr>
<th align="left"></th>
<th align="left">模块输出</th>
<th align="left">加载方式</th>
</tr>
</thead>
<tbody><tr>
<td align="left">CommonJS</td>
<td align="left">值拷贝</td>
<td align="left">对象</td>
</tr>
<tr>
<td align="left">ES6</td>
<td align="left">引用（符号链接）</td>
<td align="left">静态解析</td>
</tr>
</tbody></table>
<p>又多了几个新颖的词汇，我们先通过例子来介绍一下值拷贝和引用的区别。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">// 值拷贝 vs 引用</span><br><span class="line"></span><br><span class="line">// CommonJS</span><br><span class="line">let a = 1;</span><br><span class="line">exports.a = a;</span><br><span class="line">exports.add = () =&gt; &#123;</span><br><span class="line">    a++;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">const &#123; add, a &#125; = require(&apos;./a.js&apos;);</span><br><span class="line">add();</span><br><span class="line">console.log(a); // 1</span><br><span class="line"></span><br><span class="line">// ES6</span><br><span class="line">export const a = 1;</span><br><span class="line">export const add = () =&gt; &#123;</span><br><span class="line">    a++;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">import &#123; a, add &#125; from &apos;./a.js&apos;;</span><br><span class="line">add();</span><br><span class="line">console.log(a); // 2</span><br><span class="line">// 显而易见CommonJS和ES6之间，值拷贝和引用的区别吧。</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p><em>静态解析</em>，什么是的静态解析呢？区别于 CommonJS 的模块实现，ES6 的模块并不是一个对象，而只是代码集合。也就是说，ES6 不需要和 CommonJS 一样，需要把整个文件加载进去，形成一个对象之后，才能知道自己有什么，而是在编写代码的过程中，代码是什么，它就是什么。</p>
<p>PS:</p>
<ol>
<li>目前各个浏览器、node.js 端对 ES6 的模块化支持实际上并不友好，更多实践同志们有兴趣可以自己搞一波。</li>
<li>在 ES6 中使用 require 字样，静态解析的能力将会丢失！</li>
</ol>
<h3 id="5-UMD"><a href="#5-UMD" class="headerlink" title="5. UMD"></a>5. UMD</h3><p>模块化规范中还有一个 UMD 也不得不提及一下。什么是 UMD 呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">UMD = AMD + CommonJS</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>没错，UMD 就是这么简单。常用的场景就是当你封装的模块需要适配不同平台（浏览器、node.js），例如你写了一个基于 Date 对象二次封装的，对于时间的处理工具类，你想推广给负责前端页面开发的 A 同学和后台 Node.js 开发的 B 同学使用，你是不是就需要考虑你封装的模块，既能适配 Node.js 的 CommonJS 协议，也能适配前端同学使用的 AMD 协议？</p>
<h2 id="二、工具时代"><a href="#二、工具时代" class="headerlink" title="二、工具时代"></a>二、工具时代</h2><h3 id="1-webpack"><a href="#1-webpack" class="headerlink" title="1. webpack"></a>1. webpack</h3><p>webpack 兴起之后，什么 AMD、CMD、CommonJS、UMD，似乎都变得不重要了。因为 webpack 的模块化能力真的强。</p>
<p>webpack 在定义模块上，可以支持 CommonJS、AMD 和 ES6 的模块声明方式，换句话说，就是你的模块如果是使用 CommonJS、AMD 或 ES6 的语法写的，webpack 都支持！我们看下例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">//say-amd.js</span><br><span class="line">define(function() &#123;</span><br><span class="line">    &apos;use strict&apos;;</span><br><span class="line">    return &#123;</span><br><span class="line">        sayHello: () =&gt; &#123;</span><br><span class="line">            console.log(&apos;say hello by AMD&apos;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;);</span><br><span class="line">//say-commonjs.js</span><br><span class="line">exports.sayHello = () =&gt; &#123;</span><br><span class="line">    console.log(&apos;say hello by commonjs&apos;);</span><br><span class="line">&#125;;</span><br><span class="line">//say-es6.js</span><br><span class="line">export const sayHello = () =&gt; &#123;</span><br><span class="line">    console.log(&apos;say hello in es6&apos;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">//main</span><br><span class="line">import &#123; sayHello as sayInAMD &#125; from &apos;./say-amd&apos;;</span><br><span class="line">import &#123; sayHello as sayInCommonJS &#125; from &apos;./say-commonjs&apos;;</span><br><span class="line">import &#123; sayHello as sayInES6 &#125; from &apos;./say-es6&apos;;</span><br><span class="line"></span><br><span class="line">sayInAMD();</span><br><span class="line">sayInCommonJS();</span><br><span class="line">sayInES6();</span><br><span class="line">复制代码</span><br></pre></td></tr></table></figure>

<p>不仅如此，webpack 识别了你的模块之后，可以将其打包成 UMD、AMD 等等规范的模块重新输出。例如上文提及到的你需要把 Date 模块封装成 UMD 格式。只需要在 webpack 的 output 中添加 libraryTarget: ‘UMD’即可。</p>

      <blockquote class="mdui-m-t-5">
        
        <strong>本文链接：</strong><a href="https://longhonour.github.io/2019/09/29/moudle/">https://longhonour.github.io/2019/09/29/moudle/</a>
      </blockquote>
      
    </div>
    <footer class="mdui-card-actions">
      
        <a class="mdui-ripple article_categories-link" href="/categories/web前端/">web前端</a>
      
      
        <a class="mdui-ripple article_tags-link" href="/tags/es6/">es6</a><a class="mdui-ripple article_tags-link" href="/tags/js/">js</a>
      
    </footer>
    
  </article>
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script>$("#main article .mdui-card-content img.fancybox").on("click",function(e){$.fancybox.open({src:$(this).attr("src")});});</script>


  <nav id="paginator">
    
    <div class="spacer"></div>
    
      <a rel="next" class="extend next" href="/2019/09/25/webpack-ie/">
        下一篇&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <button aria-label="next" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_forward</i></button>
      </a>
    
  </nav>



</main>
  <footer id="footer" class="mdui-m-t-5 mdui-p-y-3 mdui-color-theme">
  <div class="mdui-p-y-0 mdui-text-center">
    
    
    
    
    
    
    
      <a href="https://github.com/longhonour" target="_blank"><i class="mdui-p-a-1 mdui-icon iconfont mdui-text-color-theme-a100">&#xe7ab;</i></a>
    
    
    
    
    
    
  </div>
  <div class="mdui-p-y-1 mdui-text-center">
    Copyright &copy; 2019 - 2019 Cao Long<br>
    
  </div>
</footer>
  <button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-theme-accent"><i class="mdui-icon material-icons">arrow_upward</i></button>
  
  <script src="/js/mdui.js"></script>
<script src="/js/script.js"></script>
</body>
</html>